<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Affiliate Management System</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone@7.18.13/babel.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            color-scheme: light dark;
        }
        
        /* Modern Dark Theme Colors */
        .dark {
            --bg-primary: #1e1e2e;
            --bg-secondary: #252535;
            --bg-tertiary: #2a2a3c;
            --text-primary: #ffffff;
            --text-secondary: #94a3b8;
            --accent-primary: #3b82f6;
            --accent-secondary: #60a5fa;
            --border-color: #2d2d44;
            --hover-bg: #2d2d44;
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }

        .dark .bg-white {
            background-color: var(--bg-secondary) !important;
        }

        .dark .bg-gray-50 {
            background-color: var(--bg-tertiary) !important;
        }

        .dark .bg-gray-100 {
            background-color: var(--bg-primary) !important;
        }

        .dark .text-gray-700 {
            color: var(--text-secondary) !important;
        }

        .dark .text-gray-900 {
            color: var(--text-primary) !important;
        }

        .dark .border {
            border-color: var(--border-color) !important;
        }

        /* Card and Container Styles */
        .dark .shadow-lg {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2) !important;
        }

        /* Button Styles */
        .dark .bg-blue-600 {
            background-color: var(--accent-primary) !important;
        }

        .dark .hover\:bg-blue-700:hover {
            background-color: var(--accent-secondary) !important;
        }

        /* Select and Input Styles */
        .dark select, .dark input {
            background-color: var(--bg-tertiary) !important;
            border-color: var(--border-color) !important;
            color: var(--text-primary) !important;
        }

        .dark select:hover, .dark input:hover {
            background-color: var(--hover-bg) !important;
        }

        /* Navigation Styles */
        .dark nav {
            background-color: var(--bg-secondary) !important;
        }

        .dark nav a:hover {
            background-color: var(--hover-bg) !important;
        }

        /* Header Styles */
        .dark header {
            background-color: var(--bg-secondary) !important;
            border-bottom: 1px solid var(--border-color) !important;
        }

        /* Settings Panel Styles */
        .dark .settings-panel {
            background-color: var(--bg-secondary) !important;
            border: 1px solid var(--border-color) !important;
            border-radius: 8px;
            padding: 1.5rem;
        }

        /* Toggle Switch Styles */
        .dark .toggle-switch {
            background-color: var(--accent-primary) !important;
        }

        .dark .toggle-switch:hover {
            background-color: var(--accent-secondary) !important;
        }

        /* Transition Effects */
        * {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        // AIHelper service
        (function(window) {
            'use strict';

            function AIHelper() {
                this.API_KEY = 'AIzaSyCEalrKbuNPw_8LkkpRELKccwdx7yAewfY';
                this.API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent';
            }

            AIHelper.prototype.generateResponse = async function(prompt) {
                try {
                    const response = await fetch(`${this.API_URL}?key=${this.API_KEY}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: prompt
                                }]
                            }]
                        })
                    });

                    const data = await response.json();
                    if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                        return data.candidates[0].content.parts[0].text;
                    } else {
                        console.error('Unexpected API response:', data);
                        return 'Sorry, received an unexpected response from the AI service.';
                    }
                } catch (error) {
                    console.error('Error:', error);
                    return 'Sorry, an error occurred while processing your request.';
                }
            };

            window.AIHelper = AIHelper;
        })(window);

        // HistoryService
        (function(window) {
            'use strict';

            function HistoryService() {
                this.STORAGE_KEY = 'ams_ai_history';
            }

            HistoryService.prototype.getHistory = function() {
                try {
                    const history = localStorage.getItem(this.STORAGE_KEY);
                    return history ? JSON.parse(history) : [];
                } catch (error) {
                    console.error('Error:', error);
                    return [];
                }
            };

            HistoryService.prototype.addToHistory = function(interaction) {
                try {
                    const history = this.getHistory();
                    const newInteraction = {
                        ...interaction,
                        timestamp: new Date().toISOString()
                    };
                    history.unshift(newInteraction);
                    localStorage.setItem(this.STORAGE_KEY, JSON.stringify(history));
                    return true;
                } catch (error) {
                    console.error('Error:', error);
                    return false;
                }
            };

            window.HistoryService = HistoryService;
        })(window);
    </script>

    <script type="text/babel">
        const ThemeContext = React.createContext({
            isDarkMode: false,
            toggleDarkMode: () => {},
        });

        function ThemeProvider({ children }) {
            const [isDarkMode, setIsDarkMode] = React.useState(() => {
                const saved = localStorage.getItem('darkMode');
                return saved === 'true';
            });

            React.useEffect(() => {
                localStorage.setItem('darkMode', isDarkMode);
                if (isDarkMode) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            }, [isDarkMode]);

            const toggleDarkMode = React.useCallback(() => {
                setIsDarkMode(prev => !prev);
            }, []);

            return (
                <ThemeContext.Provider value={{ isDarkMode, toggleDarkMode }}>
                    {children}
                </ThemeContext.Provider>
            );
        }

        function Navigation({ onPageChange, currentPage }) {
            const { isDarkMode } = React.useContext(ThemeContext);
            const menuItems = [
                { id: 'dashboard', label: 'Dashboard', icon: 'üìä' },
                { id: 'ai', label: 'AI Assistant', icon: 'ü§ñ' },
                { id: 'applications', label: 'Applications', icon: 'üìù' },
                { id: 'links', label: 'Link Manager', icon: 'üîó' },
                { id: 'earnings', label: 'Earnings', icon: 'üí∞' },
                { id: 'settings', label: 'Settings', icon: '‚öôÔ∏è' }
            ];

            return (
                <nav className={`fixed w-64 h-full overflow-y-auto ${isDarkMode ? 'bg-gray-800' : 'bg-white'} shadow-lg`}>
                    <div className="p-4">
                        <h1 className={`text-2xl font-bold ${isDarkMode ? 'text-white' : 'text-gray-800'}`}>
                            Affiliate Track
                        </h1>
                    </div>
                    <ul className="space-y-2 p-4">
                        {menuItems.map(item => (
                            <li key={item.id}>
                                <button
                                    onClick={() => onPageChange(item.id)}
                                    className={`w-full text-left px-4 py-2 rounded transition-colors ${
                                        currentPage === item.id
                                            ? `${isDarkMode ? 'bg-blue-600 text-white' : 'bg-blue-100 text-blue-700'}`
                                            : `${isDarkMode ? 'text-gray-300 hover:bg-gray-700' : 'text-gray-600 hover:bg-gray-100'}`
                                    }`}
                                >
                                    <span className="mr-3">{item.icon}</span>
                                    {item.label}
                                </button>
                            </li>
                        ))}
                    </ul>
                </nav>
            );
        }

        function Header() {
            const { isDarkMode } = React.useContext(ThemeContext);
            return (
                <header className={`${isDarkMode ? 'bg-gray-800 text-white' : 'bg-white'} shadow`}>
                    <div className="px-6 py-4">
                        <div className="flex items-center justify-between">
                            <h2 className={`text-lg font-bold ${isDarkMode ? 'text-white' : 'text-gray-800'}`}>
                                Welcome back, Admin
                            </h2>
                            <div className="flex items-center space-x-4">
                                <button className={`${isDarkMode ? 'text-gray-300 hover:text-white' : 'text-gray-600 hover:text-gray-800'}`}>
                                    <span className="mr-2">üîî</span>
                                </button>
                                <button className={`${isDarkMode ? 'text-gray-300 hover:text-white' : 'text-gray-600 hover:text-gray-800'}`}>
                                    <span className="mr-2">üë§</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </header>
            );
        }

        function DeleteButton({ onDelete, itemName }) {
            const [showConfirmation, setShowConfirmation] = React.useState(false);

            const handleDelete = () => {
                setShowConfirmation(true);
            };

            const handleConfirm = () => {
                onDelete();
                setShowConfirmation(false);
            };

            return (
                <>
                    <button
                        onClick={handleDelete}
                        className="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 flex items-center"
                    >
                        <svg className="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                        </svg>
                        Delete
                    </button>
                    <ConfirmationModal
                        isOpen={showConfirmation}
                        message={`Are you sure you want to delete ${itemName}? This action cannot be undone.`}
                        onConfirm={handleConfirm}
                        onCancel={() => setShowConfirmation(false)}
                    />
                </>
            );
        }

        function ClearDataButton({ section, onClear }) {
            const [showConfirmation, setShowConfirmation] = React.useState(false);

            const handleClear = () => {
                setShowConfirmation(true);
            };

            const handleConfirm = () => {
                onClear();
                setShowConfirmation(false);
            };

            return (
                <>
                    <button
                        onClick={handleClear}
                        className="px-4 py-2 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 flex items-center"
                    >
                        <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                        </svg>
                        Clear All Data
                    </button>
                    <ConfirmationModal
                        isOpen={showConfirmation}
                        message={`Are you sure you want to clear all data from ${section}? This will permanently delete all records and cannot be undone.`}
                        onConfirm={handleConfirm}
                        onCancel={() => setShowConfirmation(false)}
                    />
                </>
            );
        }

        function Dashboard() {
            const { isDarkMode } = React.useContext(ThemeContext);
            const [metrics, setMetrics] = React.useState({
                totalRevenue: 0,
                totalClicks: 0,
                conversionRate: 0,
                activeLinks: 0
            });
            const [revenueData, setRevenueData] = React.useState({
                labels: [],
                datasets: []
            });
            const [widgetLayout, setWidgetLayout] = React.useState({
                metrics: true,
                revenueChart: true,
                recentLinks: true,
                topPerformers: true
            });

            const chartRef = React.useRef(null);
            const [chartInstance, setChartInstance] = React.useState(null);
            const [isLoading, setIsLoading] = React.useState(true);

            React.useEffect(() => {
                // Simulate API call to fetch dashboard data
                setTimeout(() => {
                    setMetrics({
                        totalRevenue: 15234.56,
                        totalClicks: 45678,
                        conversionRate: 2.34,
                        activeLinks: 123
                    });

                    setRevenueData({
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                        datasets: [{
                            label: 'Revenue',
                            data: [1200, 1900, 3000, 5000, 4000, 3000],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            fill: true
                        }]
                    });

                    setIsLoading(false);
                }, 1000);
            }, []);

            React.useEffect(() => {
                if (chartRef.current && revenueData.labels.length > 0) {
                    if (chartInstance) {
                        chartInstance.destroy();
                    }

                    const newChartInstance = new Chart(chartRef.current, {
                        type: 'line',
                        data: revenueData,
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    position: 'top',
                                },
                                title: {
                                    display: true,
                                    text: 'Revenue Trend'
                                }
                            },
                            interaction: {
                                intersect: false,
                            },
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });

                    setChartInstance(newChartInstance);
                }
            }, [revenueData, chartRef]);

            const toggleWidget = (widgetId) => {
                setWidgetLayout(prev => ({
                    ...prev,
                    [widgetId]: !prev[widgetId]
                }));
            };

            const handleClearDashboard = async () => {
                try {
                    const response = await fetch('/api/dashboard/clear', {
                        method: 'DELETE'
                    });
                    if (response.ok) {
                        // Refresh dashboard data
                        window.location.reload();
                    }
                } catch (error) {
                    console.error('Error clearing dashboard:', error);
                }
            };

            if (isLoading) {
                return (
                    <div className="p-6">
                        <div className="animate-pulse">
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                                {[1, 2, 3, 4].map((i) => (
                                    <div key={i} className="h-32 bg-gray-200 dark:bg-gray-700 rounded-lg"></div>
                                ))}
                            </div>
                            <div className="h-64 bg-gray-200 dark:bg-gray-700 rounded-lg mb-6"></div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="p-6">
                    {/* Widget Controls */}
                    <div className="mb-6">
                        <h2 className="text-lg font-semibold mb-2 text-gray-900 dark:text-white">Customize Dashboard</h2>
                        <div className="flex flex-wrap gap-2">
                            {Object.keys(widgetLayout).map(widgetId => (
                                <button
                                    key={widgetId}
                                    onClick={() => toggleWidget(widgetId)}
                                    className={`px-3 py-1 rounded ${
                                        widgetLayout[widgetId]
                                            ? 'bg-blue-600 text-white'
                                            : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'
                                    }`}
                                >
                                    {widgetId.replace(/([A-Z])/g, ' $1').trim()}
                                </button>
                            ))}
                        </div>
                    </div>

                    {/* Metrics */}
                    {widgetLayout.metrics && (
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                            <div className="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg">
                                <h3 className="text-sm font-medium text-gray-500 dark:text-gray-400">Total Revenue</h3>
                                <p className="text-2xl font-bold text-gray-900 dark:text-white">${metrics.totalRevenue.toLocaleString()}</p>
                            </div>
                            <div className="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg">
                                <h3 className="text-sm font-medium text-gray-500 dark:text-gray-400">Total Clicks</h3>
                                <p className="text-2xl font-bold text-gray-900 dark:text-white">{metrics.totalClicks.toLocaleString()}</p>
                            </div>
                            <div className="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg">
                                <h3 className="text-sm font-medium text-gray-500 dark:text-gray-400">Conversion Rate</h3>
                                <p className="text-2xl font-bold text-gray-900 dark:text-white">{metrics.conversionRate}%</p>
                            </div>
                            <div className="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg">
                                <h3 className="text-sm font-medium text-gray-500 dark:text-gray-400">Active Links</h3>
                                <p className="text-2xl font-bold text-gray-900 dark:text-white">{metrics.activeLinks}</p>
                            </div>
                        </div>
                    )}

                    {/* Revenue Chart */}
                    {widgetLayout.revenueChart && (
                        <div className="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg mb-6">
                            <canvas ref={chartRef}></canvas>
                        </div>
                    )}

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        {/* Recent Links */}
                        {widgetLayout.recentLinks && (
                            <div className="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg">
                                <h2 className="text-lg font-semibold mb-4 text-gray-900 dark:text-white">Recent Links</h2>
                                <div className="overflow-x-auto">
                                    <table className="min-w-full">
                                        <thead>
                                            <tr>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">URL</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Clicks</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Revenue</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-gray-200 dark:divide-gray-700">
                                            <tr>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-blue-600 dark:text-blue-400">example.com/link1</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">123</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">$456.78</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {/* Top Performers */}
                        {widgetLayout.topPerformers && (
                            <div className="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg">
                                <h2 className="text-lg font-semibold mb-4 text-gray-900 dark:text-white">Top Performers</h2>
                                <div className="overflow-x-auto">
                                    <table className="min-w-full">
                                        <thead>
                                            <tr>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">URL</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Revenue</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Conversion</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-gray-200 dark:divide-gray-700">
                                            <tr>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-blue-600 dark:text-blue-400">example.com/top1</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">$1,234.56</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">5.67%</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}
                    </div>
                    <ClearDataButton section="Dashboard" onClear={handleClearDashboard} />
                </div>
            );
        }

        function AI() {
            const [loading, setLoading] = React.useState(false);
            const [selectedFunction, setSelectedFunction] = React.useState('contentGen');
            const [inputText, setInputText] = React.useState('');
            const [result, setResult] = React.useState('');
            const [history, setHistory] = React.useState([]);
            const [selectedOption, setSelectedOption] = React.useState('blog');
            const [trendResults, setTrendResults] = React.useState(null);

            const aiFunctions = {
                contentGen: {
                    title: 'Content Generation',
                    description: 'Generate engaging content for your affiliate marketing',
                    placeholder: 'Enter product description or keywords...',
                    options: [
                        { value: 'blog', label: 'Blog Post' },
                        { value: 'social', label: 'Social Media Post' },
                        { value: 'email', label: 'Email Campaign' },
                        { value: 'review', label: 'Product Review' }
                    ],
                    endpoint: '/api/ai/generate-content'
                },
                linkOpt: {
                    title: 'Link Optimization',
                    description: 'Optimize your affiliate links for better conversion',
                    placeholder: 'Enter your affiliate link...',
                    options: [
                        { value: 'shorten', label: 'URL Shortening' },
                        { value: 'tracking', label: 'Add Tracking Parameters' },
                        { value: 'analyze', label: 'Link Analysis' }
                    ],
                    endpoint: '/api/ai/optimize-link'
                },
                audience: {
                    title: 'Audience Analysis',
                    description: 'Analyze and understand your target audience',
                    placeholder: 'Enter niche or target market...',
                    options: [
                        { value: 'demographics', label: 'Demographics Analysis' },
                        { value: 'interests', label: 'Interest Mapping' },
                        { value: 'behavior', label: 'Behavior Analysis' }
                    ],
                    endpoint: '/api/ai/analyze-audience'
                },
                competitor: {
                    title: 'Competitor Analysis',
                    description: 'Analyze competitor strategies and performance',
                    placeholder: 'Enter competitor URL or name...',
                    options: [
                        { value: 'strategy', label: 'Strategy Analysis' },
                        { value: 'keywords', label: 'Keyword Analysis' },
                        { value: 'backlinks', label: 'Backlink Analysis' }
                    ],
                    endpoint: '/api/ai/analyze-competitor'
                },
                trends: {
                    title: 'Trend & Product Discovery',
                    description: 'Find trending products and matching affiliate programs',
                    placeholder: 'Enter market, niche, or product category...',
                    options: [
                        { value: 'market', label: 'Market Trends' },
                        { value: 'products', label: 'Product Discovery' },
                        { value: 'seasonal', label: 'Seasonal Trends' },
                        { value: 'affiliate', label: 'Affiliate Programs' }
                    ],
                    endpoint: '/api/ai/analyze-trends'
                }
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setLoading(true);
                setError(null);

                try {
                    const functionConfig = aiFunctions[selectedFunction];
                    const response = await fetch(functionConfig.endpoint, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            input: inputText,
                            option: selectedOption
                        })
                    });

                    if (!response.ok) {
                        throw new Error('Failed to process request');
                    }

                    const data = await response.json();
                    
                    if (selectedFunction === 'trends') {
                        setTrendResults({
                            trends: data,
                            recommendations: data.recommendations
                        });
                    }

                    setResult(JSON.stringify(data, null, 2));
                    setHistory(prev => [...prev, {
                        function: selectedFunction,
                        input: inputText,
                        option: selectedOption,
                        output: JSON.stringify(data, null, 2),
                        timestamp: new Date().toLocaleString()
                    }]);
                } catch (err) {
                    setError(err.message);
                    console.error('Error:', err);
                } finally {
                    setLoading(false);
                }
            };

            const renderTrendResults = () => {
                if (!trendResults) return null;

                const data = trendResults.trends;
                
                switch (selectedOption) {
                    case 'market':
                        return (
                            <div className="space-y-6">
                                <div>
                                    <h3 className="text-lg font-semibold mb-3">Current Market Trends</h3>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        {data.trends.map((trend, index) => (
                                            <div key={index} className="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                                                <h4 className="font-medium mb-2">{trend.trend}</h4>
                                                <p className="text-sm text-green-600 dark:text-green-400">Growth: {trend.growth}</p>
                                                <p className="text-sm text-gray-600 dark:text-gray-400">Sentiment: {trend.sentiment}</p>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                                <div>
                                    <h3 className="text-lg font-semibold mb-3">Related Product Categories</h3>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        {data.relatedProducts.map((product, index) => (
                                            <div key={index} className="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                                                <h4 className="font-medium mb-2">{product.category}</h4>
                                                <p className="text-sm text-blue-600 dark:text-blue-400">Potential: {product.potential}</p>
                                                <p className="text-sm text-gray-600 dark:text-gray-400">Competition: {product.competition}</p>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        );
                    case 'products':
                        return (
                            <div className="space-y-6">
                                <h3 className="text-lg font-semibold mb-3">Recommended Products</h3>
                                <div className="space-y-4">
                                    {data.recommendations.map((product, index) => (
                                        <div key={index} className="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                                            <div className="flex justify-between items-start mb-3">
                                                <div>
                                                    <h4 className="font-medium">{product.name}</h4>
                                                    <p className="text-sm text-gray-600 dark:text-gray-400">{product.category}</p>
                                                </div>
                                                <span className="text-green-600 dark:text-green-400 font-medium">{product.trending}</span>
                                            </div>
                                            <div>
                                                <h5 className="text-sm font-medium mb-2">Available Affiliate Programs:</h5>
                                                <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                                    {product.affiliatePrograms.map((program, idx) => (
                                                        <div key={idx} className="bg-white dark:bg-gray-800 p-3 rounded">
                                                            <h6 className="font-medium">{program.name}</h6>
                                                            <p className="text-sm text-blue-600 dark:text-blue-400">Commission: {program.commission}</p>
                                                            <div className="flex items-center text-yellow-500">
                                                                {'‚òÖ'.repeat(Math.floor(program.rating))}
                                                                <span className="text-gray-400 text-sm ml-1">({program.rating})</span>
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        );
                    case 'seasonal':
                        return (
                            <div className="space-y-6">
                                <h3 className="text-lg font-semibold mb-3">Upcoming Seasonal Trends</h3>
                                {data.upcoming.map((season, index) => (
                                    <div key={index} className="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                                        <h4 className="font-medium mb-3">{season.season}</h4>
                                        <div className="space-y-4">
                                            <div>
                                                <h5 className="text-sm font-medium mb-2">Trending Topics:</h5>
                                                <div className="flex flex-wrap gap-2">
                                                    {season.trends.map((trend, idx) => (
                                                        <span key={idx} className="px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded-full text-sm">
                                                            {trend}
                                                        </span>
                                                    ))}
                                                </div>
                                            </div>
                                            <div>
                                                <h5 className="text-sm font-medium mb-2">Hot Products:</h5>
                                                <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                                    {season.products.map((product, idx) => (
                                                        <div key={idx} className="bg-white dark:bg-gray-800 p-3 rounded">
                                                            <h6 className="font-medium">{product.name}</h6>
                                                            <p className="text-sm text-green-600 dark:text-green-400">Trending: {product.trending}</p>
                                                            <p className="text-sm text-blue-600 dark:text-blue-400">Potential: {product.potential}</p>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        );
                    case 'affiliate':
                        return (
                            <div className="space-y-6">
                                <h3 className="text-lg font-semibold mb-3">Top Affiliate Programs</h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    {data.topPrograms.map((program, index) => (
                                        <div key={index} className="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                                            <div className="flex justify-between items-start mb-3">
                                                <div>
                                                    <h4 className="font-medium">{program.name}</h4>
                                                    <p className="text-sm text-gray-600 dark:text-gray-400">{program.category}</p>
                                                </div>
                                                <div className="flex items-center text-yellow-500">
                                                    {'‚òÖ'.repeat(Math.floor(program.rating))}
                                                    <span className="text-gray-400 text-sm ml-1">({program.rating})</span>
                                                </div>
                                            </div>
                                            <div className="space-y-2">
                                                <p className="text-sm"><span className="font-medium">Commission:</span> {program.commission}</p>
                                                <p className="text-sm"><span className="font-medium">Requirements:</span> {program.requirements}</p>
                                                <div>
                                                    <p className="text-sm font-medium mb-1">Popular Products:</p>
                                                    <div className="flex flex-wrap gap-2">
                                                        {program.products.map((product, idx) => (
                                                            <span key={idx} className="px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded text-sm">
                                                                {product}
                                                            </span>
                                                        ))}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        );
                    default:
                        return null;
                }
            };

            return (
                <div className="p-6">
                    <h1 className="text-2xl font-bold mb-6 text-gray-900 dark:text-white">AI Assistant</h1>
                    
                    {/* Function Selection */}
                    <div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-8">
                        {Object.entries(aiFunctions).map(([key, func]) => (
                            <button
                                key={key}
                                onClick={() => setSelectedFunction(key)}
                                className={`p-4 rounded-lg transition-all ${
                                    selectedFunction === key
                                        ? 'bg-blue-600 text-white shadow-lg transform scale-105'
                                        : 'bg-white dark:bg-gray-800 text-gray-900 dark:text-white hover:shadow-md'
                                }`}
                            >
                                <h3 className="font-semibold mb-2">{func.title}</h3>
                                <p className="text-sm opacity-80">{func.description}</p>
                            </button>
                        ))}
                    </div>

                    {/* Input Form */}
                    <div className="bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg mb-8">
                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    {aiFunctions[selectedFunction].title}
                                </label>
                                <textarea
                                    value={inputText}
                                    onChange={(e) => setInputText(e.target.value)}
                                    placeholder={aiFunctions[selectedFunction].placeholder}
                                    className="w-full p-3 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white"
                                    rows="4"
                                ></textarea>
                            </div>
                            
                            <div>
                                <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    Options
                                </label>
                                <div className="flex flex-wrap gap-2">
                                    {aiFunctions[selectedFunction].options.map((option) => (
                                        <button
                                            key={option.value}
                                            type="button"
                                            onClick={() => setSelectedOption(option.value)}
                                            className={`px-4 py-2 rounded-full text-sm ${
                                                selectedOption === option.value
                                                    ? 'bg-blue-600 text-white'
                                                    : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'
                                            }`}
                                        >
                                            {option.label}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            <button
                                type="submit"
                                disabled={loading}
                                className={`w-full py-3 rounded-lg text-white font-medium ${
                                    loading
                                        ? 'bg-gray-400 cursor-not-allowed'
                                        : 'bg-blue-600 hover:bg-blue-700'
                                }`}
                            >
                                {loading ? (
                                    <span className="flex items-center justify-center">
                                        <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                        </svg>
                                        Processing...
                                    </span>
                                ) : 'Analyze'}
                            </button>
                        </form>
                    </div>

                    {/* Results */}
                    {(result || trendResults) && (
                        <div className="bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg mb-8">
                            <h2 className="text-lg font-semibold mb-4 text-gray-900 dark:text-white">Results</h2>
                            {selectedFunction === 'trends' ? (
                                renderTrendResults()
                            ) : (
                                <div className="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                                    <pre className="whitespace-pre-wrap text-sm text-gray-800 dark:text-gray-200">
                                        {result}
                                    </pre>
                                </div>
                            )}
                        </div>
                    )}

                    {/* History */}
                    {history.length > 0 && (
                        <div className="bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg">
                            <h2 className="text-lg font-semibold mb-4 text-gray-900 dark:text-white">History</h2>
                            <div className="space-y-4">
                                {history.map((item, index) => (
                                    <div key={index} className="border-b dark:border-gray-700 pb-4">
                                        <div className="flex justify-between items-start mb-2">
                                            <span className="font-medium text-gray-900 dark:text-white">
                                                {aiFunctions[item.function].title}
                                            </span>
                                            <span className="text-sm text-gray-500 dark:text-gray-400">
                                                {item.timestamp}
                                            </span>
                                        </div>
                                        <p className="text-sm text-gray-600 dark:text-gray-300 mb-2">Input: {item.input}</p>
                                        <p className="text-sm text-gray-600 dark:text-gray-300 mb-2">Option: {item.option}</p>
                                        <p className="text-sm text-gray-800 dark:text-gray-200">Output: {item.output}</p>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        function LinkManager() {
            const { isDarkMode } = React.useContext(ThemeContext);
            const [links, setLinks] = React.useState([
                {
                    id: 1,
                    program: 'Amazon Associates',
                    url: 'https://amazon.com/product1',
                    shortUrl: 'amzn.to/abc123',
                    clicks: 145,
                    revenue: 250.50,
                    lastClick: '2024-12-25',
                    category: 'Electronics',
                    tags: ['tech', 'gadgets'],
                    status: 'active'
                },
                {
                    id: 2,
                    program: 'ClickBank',
                    url: 'https://clickbank.com/product1',
                    shortUrl: 'clkbnk.to/xyz789',
                    clicks: 89,
                    revenue: 175.25,
                    lastClick: '2024-12-24',
                    category: 'Health & Fitness',
                    tags: ['fitness', 'health'],
                    status: 'active'
                }
            ]);

            const [selectedLinks, setSelectedLinks] = React.useState([]);
            const [filters, setFilters] = React.useState({
                search: '',
                status: 'all',
                category: 'all',
                dateRange: 'all'
            });
            const [sortConfig, setSortConfig] = React.useState({
                key: 'clicks',
                direction: 'desc'
            });

            const bulkActions = {
                delete: () => {
                    if (window.confirm(`Delete ${selectedLinks.length} selected links?`)) {
                        setLinks(prev => prev.filter(link => !selectedLinks.includes(link.id)));
                        setSelectedLinks([]);
                    }
                },
                enable: () => {
                    setLinks(prev => prev.map(link => 
                        selectedLinks.includes(link.id) ? { ...link, status: 'active' } : link
                    ));
                    setSelectedLinks([]);
                },
                disable: () => {
                    setLinks(prev => prev.map(link => 
                        selectedLinks.includes(link.id) ? { ...link, status: 'inactive' } : link
                    ));
                    setSelectedLinks([]);
                }
            };

            const exportData = (format) => {
                const filteredLinks = applyFilters(links);
                
                if (format === 'csv') {
                    const csv = convertToCSV(filteredLinks);
                    downloadFile(csv, 'links_export.csv', 'text/csv');
                } else if (format === 'pdf') {
                    // Implementation for PDF export
                    alert('PDF export coming soon');
                }
            };

            const convertToCSV = (data) => {
                const headers = ['ID', 'URL', 'Clicks', 'Revenue', 'Status', 'Category'];
                const rows = data.map(link => [
                    link.id,
                    link.url,
                    link.clicks,
                    link.revenue,
                    link.status,
                    link.category
                ]);
                return [headers, ...rows].map(row => row.join(',')).join('\n');
            };

            const downloadFile = (content, filename, type) => {
                const blob = new Blob([content], { type });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };

            const applyFilters = (data) => {
                return data.filter(link => {
                    const matchesSearch = link.url.toLowerCase().includes(filters.search.toLowerCase());
                    const matchesStatus = filters.status === 'all' || link.status === filters.status;
                    const matchesCategory = filters.category === 'all' || link.category === filters.category;
                    return matchesSearch && matchesStatus && matchesCategory;
                });
            };

            const handleDeleteLink = async (id) => {
                try {
                    const response = await fetch(`/api/links/${id}`, {
                        method: 'DELETE'
                    });
                    if (response.ok) {
                        // Remove link from list
                        setLinks(prev => prev.filter(link => link.id !== id));
                    }
                } catch (error) {
                    console.error('Error deleting link:', error);
                }
            };

            return (
                <div className="p-6">
                    {/* Toolbar */}
                    <div className="mb-6 flex justify-between items-center">
                        <h1 className="text-2xl font-bold text-gray-900 dark:text-white">Link Manager</h1>
                        <div className="flex space-x-2">
                            <input
                                type="text"
                                placeholder="Search links..."
                                className="px-4 py-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                                value={filters.search}
                                onChange={e => setFilters(prev => ({ ...prev, search: e.target.value }))}
                            />
                            <select
                                value={filters.status}
                                onChange={e => setFilters(prev => ({ ...prev, status: e.target.value }))}
                                className="px-4 py-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                            >
                                <option value="all">All Status</option>
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                            <select
                                value={filters.category}
                                onChange={e => setFilters(prev => ({ ...prev, category: e.target.value }))}
                                className="px-4 py-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                            >
                                <option value="all">All Categories</option>
                                <option value="social">Social</option>
                                <option value="blog">Blog</option>
                                <option value="affiliate">Affiliate</option>
                            </select>
                        </div>
                        <div className="flex space-x-2">
                            <button
                                onClick={() => exportData('csv')}
                                className="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
                            >
                                Export CSV
                            </button>
                            <button
                                onClick={() => exportData('pdf')}
                                className="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"
                            >
                                Export PDF
                            </button>
                        </div>
                    </div>

                    {/* Bulk Actions */}
                    {selectedLinks.length > 0 && (
                        <div className="mb-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg">
                            <div className="flex items-center justify-between">
                                <span>{selectedLinks.length} links selected</span>
                                <div className="space-x-2">
                                    <button
                                        onClick={bulkActions.enable}
                                        className="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
                                    >
                                        Enable
                                    </button>
                                    <button
                                        onClick={bulkActions.disable}
                                        className="px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700"
                                    >
                                        Disable
                                    </button>
                                    <button
                                        onClick={bulkActions.delete}
                                        className="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"
                                    >
                                        Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Links Table */}
                    <div className="bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden">
                        <table className="min-w-full divide-y divide-gray-200 dark:divide-gray-600">
                            <thead className="bg-gray-50 dark:bg-gray-800">
                                <tr>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                        ID
                                    </th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                        URL
                                    </th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                        Clicks
                                    </th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                        Revenue
                                    </th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                        Status
                                    </th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                        Category
                                    </th>
                                </tr>
                            </thead>
                            <tbody className="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-600">
                                {links.map((link) => (
                                    <tr key={link.id}>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <div className="text-sm text-gray-900 dark:text-white">{link.id}</div>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <div className="text-sm text-blue-600 dark:text-blue-400">{link.url}</div>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <div className="text-sm text-gray-900 dark:text-white">{link.clicks}</div>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <div className="text-sm text-gray-900 dark:text-white">${link.revenue.toFixed(2)}</div>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${
                                                link.status === 'active'
                                                    ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200'
                                                    : 'bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200'
                                            }`}>
                                                {link.status}
                                            </span>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <div className="text-sm text-gray-500 dark:text-gray-300">{link.category}</div>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <DeleteButton onDelete={() => handleDeleteLink(link.id)} itemName={link.url} />
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                    <ClearDataButton section="Links" onClear={() => setLinks([])} />
                </div>
            );
        }

        function PlaceholderPage({ title }) {
            return (
                <div className="p-6">
                    <h1 className="text-2xl font-bold">{title}</h1>
                    <p className="text-gray-600">This page is coming soon...</p>
                </div>
            );
        }

        function ProgramDetails({ program, onClose }) {
            const [activeTab, setActiveTab] = React.useState('links');
            const [links, setLinks] = React.useState([
                {
                    id: 1,
                    url: 'https://amazon.com/product1',
                    shortUrl: 'amzn.to/abc123',
                    clicks: 145,
                    revenue: 250.50,
                    lastClick: '2024-12-25',
                    category: 'Electronics'
                },
                {
                    id: 2,
                    url: 'https://amazon.com/product2',
                    shortUrl: 'amzn.to/def456',
                    clicks: 89,
                    revenue: 175.25,
                    lastClick: '2024-12-24',
                    category: 'Home'
                }
            ]);

            const [products, setProducts] = React.useState([
                {
                    id: 1,
                    name: 'Wireless Earbuds',
                    price: 79.99,
                    commission: '4%',
                    sales: 12,
                    revenue: 38.40,
                    category: 'Electronics',
                    status: 'active'
                },
                {
                    id: 2,
                    name: 'Smart Home Hub',
                    price: 129.99,
                    commission: '3%',
                    sales: 8,
                    revenue: 31.20,
                    category: 'Home',
                    status: 'active'
                }
            ]);

            return (
                <div className="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center overflow-y-auto">
                    <div className="bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-6xl m-4">
                        <div className="flex justify-between items-center mb-6">
                            <div>
                                <h2 className="text-2xl font-bold">{program.program}</h2>
                                <p className="text-sm text-gray-600 dark:text-gray-300 mb-2">
                                    Website: {program.website} | Category: {program.category}
                                </p>
                            </div>
                            <button
                                onClick={onClose}
                                className="text-gray-500 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-500"
                            >
                                ‚úï
                            </button>
                        </div>

                        <div className="mb-6">
                            <div className="border-b border-gray-200 dark:border-gray-600">
                                <nav className="-mb-px flex space-x-8">
                                    <button
                                        onClick={() => setActiveTab('links')}
                                        className={`py-4 px-1 border-b-2 font-medium text-sm ${
                                            activeTab === 'links'
                                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'
                                                : 'border-transparent text-gray-500 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-500 hover:border-gray-300 dark:hover:border-gray-600'
                                        }`}
                                    >
                                        Affiliate Links
                                    </button>
                                    <button
                                        onClick={() => setActiveTab('products')}
                                        className={`py-4 px-1 border-b-2 font-medium text-sm ${
                                            activeTab === 'products'
                                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'
                                                : 'border-transparent text-gray-500 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-500 hover:border-gray-300 dark:hover:border-gray-600'
                                        }`}
                                    >
                                        Products
                                    </button>
                                </nav>
                            </div>
                        </div>

                        {activeTab === 'links' ? (
                            <div>
                                <div className="flex justify-between mb-4">
                                    <h3 className="text-lg font-medium">Affiliate Links</h3>
                                    <button className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors">
                                        Add New Link
                                    </button>
                                </div>
                                <div className="overflow-x-auto">
                                    <table className="min-w-full divide-y divide-gray-200 dark:divide-gray-600">
                                        <thead className="bg-gray-50 dark:bg-gray-800">
                                            <tr>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Short URL
                                                </th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Original URL
                                                </th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Clicks
                                                </th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Revenue
                                                </th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Last Click
                                                </th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Category
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody className="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600">
                                            {links.map((link) => (
                                                <tr key={link.id}>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm font-medium text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 cursor-pointer">
                                                            {link.shortUrl}
                                                        </div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm text-gray-900 dark:text-white">{link.url}</div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm text-gray-900 dark:text-white">{link.clicks}</div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm text-gray-900 dark:text-white">${link.revenue.toFixed(2)}</div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm text-gray-500 dark:text-gray-300">{link.lastClick}</div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm text-gray-500 dark:text-gray-300">{link.category}</div>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        ) : (
                            <div>
                                <div className="flex justify-between mb-4">
                                    <h3 className="text-lg font-medium">Products</h3>
                                    <button className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors">
                                        Add New Product
                                    </button>
                                </div>
                                <div className="overflow-x-auto">
                                    <table className="min-w-full divide-y divide-gray-200 dark:divide-gray-600">
                                        <thead className="bg-gray-50 dark:bg-gray-800">
                                            <tr>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Name
                                                </th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Price
                                                </th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Commission
                                                </th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Sales
                                                </th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Revenue
                                                </th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Category
                                                </th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Status
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody className="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600">
                                            {products.map((product) => (
                                                <tr key={product.id}>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm font-medium text-gray-900 dark:text-white">
                                                            {product.name}
                                                        </div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm text-gray-900 dark:text-white">
                                                            ${product.price.toFixed(2)}
                                                        </div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm text-gray-900 dark:text-white">{product.commission}</div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm text-gray-900 dark:text-white">{product.sales}</div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm text-gray-900 dark:text-white">
                                                            ${product.revenue.toFixed(2)}
                                                        </div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm text-gray-500 dark:text-gray-300">{product.category}</div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${
                                                            product.status === 'active'
                                                                ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200'
                                                                : 'bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200'
                                                        }`}>
                                                            {product.status}
                                                        </span>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        function Applications() {
            const [applications, setApplications] = React.useState([
                { 
                    id: 1, 
                    program: 'Amazon Associates',
                    website: 'techreviews.com',
                    status: 'pending',
                    submittedDate: '2024-12-20',
                    category: 'E-commerce',
                    notes: 'Awaiting review',
                    lastUpdated: '2024-12-20'
                },
                { 
                    id: 2, 
                    program: 'ClickBank',
                    website: 'fitnessguide.net',
                    status: 'approved',
                    submittedDate: '2024-12-15',
                    category: 'Health & Fitness',
                    notes: 'Approved on 12/18',
                    lastUpdated: '2024-12-18'
                },
                { 
                    id: 3, 
                    program: 'ShareASale',
                    website: 'homedesign.blog',
                    status: 'rejected',
                    submittedDate: '2024-12-10',
                    category: 'Home & Garden',
                    notes: 'Insufficient traffic',
                    lastUpdated: '2024-12-12'
                }
            ]);

            const [showForm, setShowForm] = React.useState(false);
            const [showUpdateModal, setShowUpdateModal] = React.useState(false);
            const [selectedApp, setSelectedApp] = React.useState(null);
            const [updateNote, setUpdateNote] = React.useState('');
            const [searchTerm, setSearchTerm] = React.useState('');
            const [selectedCategory, setSelectedCategory] = React.useState('all');
            const [selectedStatus, setSelectedStatus] = React.useState('all');
            const [sortConfig, setSortConfig] = React.useState({ key: 'submittedDate', direction: 'desc' });

            const categories = ['E-commerce', 'Health & Fitness', 'Home & Garden'];
            const statuses = ['pending', 'approved', 'rejected'];

            const handleSort = (key) => {
                let direction = 'asc';
                if (sortConfig.key === key && sortConfig.direction === 'asc') {
                    direction = 'desc';
                }
                setSortConfig({ key, direction });
            };

            const filteredApplications = applications.filter(app => {
                const matchesSearch = (
                    app.program.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    app.website.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    app.notes.toLowerCase().includes(searchTerm.toLowerCase())
                );
                const matchesCategory = selectedCategory === 'all' || app.category === selectedCategory;
                const matchesStatus = selectedStatus === 'all' || app.status === selectedStatus;
                return matchesSearch && matchesCategory && matchesStatus;
            }).sort((a, b) => {
                if (!sortConfig.key) return 0;
                
                let aValue = a[sortConfig.key];
                let bValue = b[sortConfig.key];
                
                if (typeof aValue === 'string') {
                    aValue = aValue.toLowerCase();
                    bValue = bValue.toLowerCase();
                }
                
                if (aValue < bValue) return sortConfig.direction === 'asc' ? -1 : 1;
                if (aValue > bValue) return sortConfig.direction === 'asc' ? 1 : -1;
                return 0;
            });

            const [newApplication, setNewApplication] = React.useState({
                program: '',
                website: '',
                category: '',
                notes: ''
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                const application = {
                    id: applications.length + 1,
                    ...newApplication,
                    status: 'pending',
                    submittedDate: new Date().toISOString().split('T')[0],
                    lastUpdated: new Date().toISOString().split('T')[0]
                };
                setApplications([application, ...applications]);
                setShowForm(false);
                setNewApplication({ program: '', website: '', category: '', notes: '' });
            };

            const handleStatusUpdate = (app) => {
                setSelectedApp(app);
                setUpdateNote('');
                setShowUpdateModal(true);
            };

            const submitStatusUpdate = (newStatus) => {
                const updatedApplications = applications.map(app => {
                    if (app.id === selectedApp.id) {
                        return {
                            ...app,
                            status: newStatus,
                            notes: updateNote ? `${updateNote}\n${app.notes}` : app.notes,
                            lastUpdated: new Date().toISOString().split('T')[0]
                        };
                    }
                    return app;
                });
                setApplications(updatedApplications);
                setShowUpdateModal(false);
                setSelectedApp(null);
                setUpdateNote('');
            };

            const getStatusColor = (status) => {
                switch (status) {
                    case 'approved':
                        return 'bg-green-100 text-green-800';
                    case 'rejected':
                        return 'bg-red-100 text-red-800';
                    default:
                        return 'bg-yellow-100 text-yellow-800';
                }
            };

            const handleDeleteApplication = async (id) => {
                try {
                    const response = await fetch(`/api/applications/${id}`, {
                        method: 'DELETE'
                    });
                    if (response.ok) {
                        // Remove application from list
                        setApplications(prev => prev.filter(app => app.id !== id));
                    }
                } catch (error) {
                    console.error('Error deleting application:', error);
                }
            };

            return (
                <div className="p-6">
                    <div className="mb-6">
                        <div className="flex justify-between items-center mb-4">
                            <h1 className="text-2xl font-bold">Applications</h1>
                            <button
                                onClick={() => setShowForm(true)}
                                className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"
                            >
                                New Application
                            </button>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div className="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
                                <div className="text-sm text-gray-500 dark:text-gray-300">Total Applications</div>
                                <div className="text-2xl font-bold">{filteredApplications.length}</div>
                            </div>
                            <div className="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
                                <div className="text-sm text-gray-500 dark:text-gray-300">Pending Review</div>
                                <div className="text-2xl font-bold">
                                    {filteredApplications.filter(app => app.status === 'pending').length}
                                </div>
                            </div>
                            <div className="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
                                <div className="text-sm text-gray-500 dark:text-gray-300">Approved</div>
                                <div className="text-2xl font-bold">
                                    {filteredApplications.filter(app => app.status === 'approved').length}
                                </div>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                            <input
                                type="text"
                                placeholder="Search applications..."
                                value={searchTerm}
                                onChange={(e) => setSearchTerm(e.target.value)}
                                className="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                            />
                            <div>
                                <select
                                    value={selectedCategory}
                                    onChange={(e) => setSelectedCategory(e.target.value)}
                                    className="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                                >
                                    <option value="all">All Categories</option>
                                    {categories.map(category => (
                                        <option key={category} value={category}>{category}</option>
                                    ))}
                                </select>
                            </div>
                            <div>
                                <select
                                    value={selectedStatus}
                                    onChange={(e) => setSelectedStatus(e.target.value)}
                                    className="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                                >
                                    <option value="all">All Statuses</option>
                                    {statuses.map(status => (
                                        <option key={status} value={status}>{status}</option>
                                    ))}
                                </select>
                            </div>
                        </div>
                    </div>

                    {showUpdateModal && selectedApp && (
                        <div className="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center">
                            <div className="bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-xl font-bold">Update Status</h2>
                                    <button
                                        onClick={() => setShowUpdateModal(false)}
                                        className="text-gray-500 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-500"
                                    >
                                        ‚úï
                                    </button>
                                </div>
                                <div className="mb-4">
                                    <p className="text-sm text-gray-600 dark:text-gray-300 mb-2">
                                        Updating status for: <span className="font-medium">{selectedApp.program}</span>
                                    </p>
                                    <div className="space-y-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                                New Status
                                            </label>
                                            <div className="grid grid-cols-3 gap-2">
                                                <button
                                                    onClick={() => submitStatusUpdate('approved')}
                                                    className="px-4 py-2 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 rounded hover:bg-green-200 dark:hover:bg-green-800"
                                                >
                                                    Approve
                                                </button>
                                                <button
                                                    onClick={() => submitStatusUpdate('rejected')}
                                                    className="px-4 py-2 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 rounded hover:bg-red-200 dark:hover:bg-red-800"
                                                >
                                                    Reject
                                                </button>
                                                <button
                                                    onClick={() => submitStatusUpdate('pending')}
                                                    className="px-4 py-2 bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded hover:bg-yellow-200 dark:hover:bg-yellow-800"
                                                >
                                                    Pending
                                                </button>
                                            </div>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                                Update Note (Optional)
                                            </label>
                                            <textarea
                                                value={updateNote}
                                                onChange={(e) => setUpdateNote(e.target.value)}
                                                className="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                                                rows="3"
                                                placeholder="Add a note about this status update..."
                                            />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {showForm && (
                        <div className="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center">
                            <div className="bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-xl font-bold">New Application</h2>
                                    <button
                                        onClick={() => setShowForm(false)}
                                        className="text-gray-500 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-500"
                                    >
                                        ‚úï
                                    </button>
                                </div>
                                <form onSubmit={handleSubmit} className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                            Program
                                        </label>
                                        <input
                                            type="text"
                                            required
                                            value={newApplication.program}
                                            onChange={(e) => setNewApplication({
                                                ...newApplication,
                                                program: e.target.value
                                            })}
                                            className="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                            Website
                                        </label>
                                        <input
                                            type="text"
                                            required
                                            value={newApplication.website}
                                            onChange={(e) => setNewApplication({
                                                ...newApplication,
                                                website: e.target.value
                                            })}
                                            className="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                            Category
                                        </label>
                                        <select
                                            required
                                            value={newApplication.category}
                                            onChange={(e) => setNewApplication({
                                                ...newApplication,
                                                category: e.target.value
                                            })}
                                            className="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                                        >
                                            <option value="">Select a category</option>
                                            {categories.map(category => (
                                                <option key={category} value={category}>{category}</option>
                                            ))}
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                            Notes
                                        </label>
                                        <textarea
                                            value={newApplication.notes}
                                            onChange={(e) => setNewApplication({
                                                ...newApplication,
                                                notes: e.target.value
                                            })}
                                            className="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                                            rows="3"
                                        />
                                    </div>
                                    <div className="flex justify-end space-x-2">
                                        <button
                                            type="button"
                                            onClick={() => setShowForm(false)}
                                            className="px-4 py-2 text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-500"
                                        >
                                            Cancel
                                        </button>
                                        <button
                                            type="submit"
                                            className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"
                                        >
                                            Submit
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}

                    <div className="bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden">
                        <div className="overflow-x-auto">
                            <table className="min-w-full divide-y divide-gray-200 dark:divide-gray-600">
                                <thead className="bg-gray-50 dark:bg-gray-800">
                                    <tr>
                                        <th 
                                            className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700"
                                            onClick={() => handleSort('program')}
                                        >
                                            Program
                                            {sortConfig.key === 'program' && (
                                                <span className="ml-1">
                                                    {sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì'}
                                                </span>
                                            )}
                                        </th>
                                        <th 
                                            className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700"
                                            onClick={() => handleSort('website')}
                                        >
                                            Website
                                            {sortConfig.key === 'website' && (
                                                <span className="ml-1">
                                                    {sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì'}
                                                </span>
                                            )}
                                        </th>
                                        <th 
                                            className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700"
                                            onClick={() => handleSort('status')}
                                        >
                                            Status
                                            {sortConfig.key === 'status' && (
                                                <span className="ml-1">
                                                    {sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì'}
                                                </span>
                                            )}
                                        </th>
                                        <th 
                                            className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700"
                                            onClick={() => handleSort('submittedDate')}
                                        >
                                            Submitted
                                            {sortConfig.key === 'submittedDate' && (
                                                <span className="ml-1">
                                                    {sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì'}
                                                </span>
                                            )}
                                        </th>
                                        <th 
                                            className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700"
                                            onClick={() => handleSort('lastUpdated')}
                                        >
                                            Last Updated
                                            {sortConfig.key === 'lastUpdated' && (
                                                <span className="ml-1">
                                                    {sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì'}
                                                </span>
                                            )}
                                        </th>
                                        <th 
                                            className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700"
                                            onClick={() => handleSort('category')}
                                        >
                                            Category
                                            {sortConfig.key === 'category' && (
                                                <span className="ml-1">
                                                    {sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì'}
                                                </span>
                                            )}
                                        </th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Notes
                                        </th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Actions
                                        </th>
                                    </tr>
                                </thead>
                                <tbody className="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-600">
                                    {filteredApplications.map((app) => (
                                        <tr key={app.id}>
                                            <td className="px-6 py-4 whitespace-nowrap">
                                                <div className="text-sm font-medium text-gray-900 dark:text-white cursor-pointer hover:text-blue-600 dark:hover:text-blue-400"
                                                     onClick={() => setSelectedProgram(app)}>
                                                    {app.program}
                                                </div>
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap">
                                                <div className="text-sm text-gray-900 dark:text-white">{app.website}</div>
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap">
                                                <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(app.status)}`}>
                                                    {app.status}
                                                </span>
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300">
                                                {app.submittedDate}
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300">
                                                {app.lastUpdated}
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300">
                                                {app.category}
                                            </td>
                                            <td className="px-6 py-4 text-sm text-gray-500 dark:text-gray-300">
                                                {app.notes}
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300">
                                                <button
                                                    onClick={() => handleStatusUpdate(app)}
                                                    className="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300"
                                                >
                                                    Update Status
                                                </button>
                                                <DeleteButton onDelete={() => handleDeleteApplication(app.id)} itemName={app.program} />
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <ClearDataButton section="Applications" onClear={() => setApplications([])} />
                </div>
            );
        }

        function Earnings() {
            const { isDarkMode } = React.useContext(ThemeContext);
            const [earnings, setEarnings] = React.useState([
                {
                    id: 1,
                    program: 'Amazon Associates',
                    date: '2024-12-25',
                    clicks: 145,
                    sales: 12,
                    revenue: 250.50,
                    commission: 25.05,
                    status: 'pending',
                    category: 'Electronics'
                },
                {
                    id: 2,
                    program: 'ClickBank',
                    date: '2024-12-24',
                    clicks: 89,
                    sales: 5,
                    revenue: 175.25,
                    commission: 43.81,
                    status: 'paid',
                    category: 'Health & Fitness'
                },
                {
                    id: 3,
                    program: 'ShareASale',
                    date: '2024-12-23',
                    clicks: 67,
                    sales: 3,
                    revenue: 120.75,
                    commission: 18.11,
                    status: 'paid',
                    category: 'Home & Garden'
                }
            ]);

            const [dateRange, setDateRange] = React.useState('week');
            const [selectedProgram, setSelectedProgram] = React.useState('all');
            const [selectedStatus, setSelectedStatus] = React.useState('all');
            const [sortConfig, setSortConfig] = React.useState({ key: 'date', direction: 'desc' });

            const programs = ['Amazon Associates', 'ClickBank', 'ShareASale'];
            const statuses = ['pending', 'paid'];

            const handleSort = (key) => {
                let direction = 'asc';
                if (sortConfig.key === key && sortConfig.direction === 'asc') {
                    direction = 'desc';
                }
                setSortConfig({ key, direction });
            };

            const filteredEarnings = earnings.filter(earning => {
                const matchesProgram = selectedProgram === 'all' || earning.program === selectedProgram;
                const matchesStatus = selectedStatus === 'all' || earning.status === selectedStatus;
                return matchesProgram && matchesStatus;
            }).sort((a, b) => {
                if (!sortConfig.key) return 0;
                
                let aValue = a[sortConfig.key];
                let bValue = b[sortConfig.key];
                
                if (typeof aValue === 'string') {
                    aValue = aValue.toLowerCase();
                    bValue = bValue.toLowerCase();
                }
                
                if (aValue < bValue) return sortConfig.direction === 'asc' ? -1 : 1;
                if (aValue > bValue) return sortConfig.direction === 'asc' ? 1 : -1;
                return 0;
            });

            const totalClicks = filteredEarnings.reduce((sum, earning) => sum + earning.clicks, 0);
            const totalSales = filteredEarnings.reduce((sum, earning) => sum + earning.sales, 0);
            const totalRevenue = filteredEarnings.reduce((sum, earning) => sum + earning.revenue, 0);
            const totalCommission = filteredEarnings.reduce((sum, earning) => sum + earning.commission, 0);
            const conversionRate = totalClicks > 0 ? ((totalSales / totalClicks) * 100).toFixed(2) : 0;

            React.useEffect(() => {
                // Revenue by Program Chart
                const programCtx = document.getElementById('revenueByProgram');
                if (programCtx) {
                    const programData = programs.map(program => {
                        return filteredEarnings
                            .filter(earning => earning.program === program)
                            .reduce((sum, earning) => sum + earning.revenue, 0);
                    });

                    new Chart(programCtx, {
                        type: 'pie',
                        data: {
                            labels: programs,
                            datasets: [{
                                data: programData,
                                backgroundColor: [
                                    'rgba(54, 162, 235, 0.8)',
                                    'rgba(75, 192, 192, 0.8)',
                                    'rgba(153, 102, 255, 0.8)'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });
                }

                // Daily Revenue Chart
                const revenueCtx = document.getElementById('dailyRevenue');
                if (revenueCtx) {
                    const dates = [...new Set(filteredEarnings.map(earning => earning.date))].sort();
                    const dailyRevenue = dates.map(date => {
                        return filteredEarnings
                            .filter(earning => earning.date === date)
                            .reduce((sum, earning) => sum + earning.revenue, 0);
                    });

                    new Chart(revenueCtx, {
                        type: 'line',
                        data: {
                            labels: dates,
                            datasets: [{
                                label: 'Daily Revenue',
                                data: dailyRevenue,
                                borderColor: 'rgb(75, 192, 192)',
                                tension: 0.1
                            }]
                        },
                        options: {
                            responsive: true,
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                }
            }, [filteredEarnings]);

            const handleDeleteEarning = async (id) => {
                try {
                    const response = await fetch(`/api/earnings/${id}`, {
                        method: 'DELETE'
                    });
                    if (response.ok) {
                        // Remove earning from list
                        setEarnings(prev => prev.filter(earning => earning.id !== id));
                    }
                } catch (error) {
                    console.error('Error deleting earning:', error);
                }
            };

            return (
                <div className="p-6">
                    <div className="mb-6">
                        <div className="flex justify-between items-center mb-4">
                            <h1 className="text-2xl font-bold">Earnings</h1>
                            <div className="flex gap-2">
                                <button
                                    onClick={() => setDateRange('week')}
                                    className={`px-4 py-2 rounded ${
                                        dateRange === 'week'
                                            ? 'bg-blue-600 text-white'
                                            : 'bg-gray-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'
                                    }`}
                                >
                                    Week
                                </button>
                                <button
                                    onClick={() => setDateRange('month')}
                                    className={`px-4 py-2 rounded ${
                                        dateRange === 'month'
                                            ? 'bg-blue-600 text-white'
                                            : 'bg-gray-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'
                                    }`}
                                >
                                    Month
                                </button>
                                <button
                                    onClick={() => setDateRange('year')}
                                    className={`px-4 py-2 rounded ${
                                        dateRange === 'year'
                                            ? 'bg-blue-600 text-white'
                                            : 'bg-gray-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'
                                    }`}
                                >
                                    Year
                                </button>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
                            <div className="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
                                <div className="text-sm text-gray-500 dark:text-gray-300">Total Revenue</div>
                                <div className="text-2xl font-bold">${totalRevenue.toFixed(2)}</div>
                            </div>
                            <div className="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
                                <div className="text-sm text-gray-500 dark:text-gray-300">Total Commission</div>
                                <div className="text-2xl font-bold">${totalCommission.toFixed(2)}</div>
                            </div>
                            <div className="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
                                <div className="text-sm text-gray-500 dark:text-gray-300">Total Sales</div>
                                <div className="text-2xl font-bold">{totalSales}</div>
                            </div>
                            <div className="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
                                <div className="text-sm text-gray-500 dark:text-gray-300">Total Clicks</div>
                                <div className="text-2xl font-bold">{totalClicks}</div>
                            </div>
                            <div className="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
                                <div className="text-sm text-gray-500 dark:text-gray-300">Conversion Rate</div>
                                <div className="text-2xl font-bold">{conversionRate}%</div>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <div className="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
                                <h3 className="text-lg font-medium mb-4">Revenue by Program</h3>
                                <canvas id="revenueByProgram"></canvas>
                            </div>
                            <div className="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
                                <h3 className="text-lg font-medium mb-4">Daily Revenue</h3>
                                <canvas id="dailyRevenue"></canvas>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div>
                                <select
                                    value={selectedProgram}
                                    onChange={(e) => setSelectedProgram(e.target.value)}
                                    className="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                                >
                                    <option value="all">All Programs</option>
                                    {programs.map(program => (
                                        <option key={program} value={program}>{program}</option>
                                    ))}
                                </select>
                            </div>
                            <div>
                                <select
                                    value={selectedStatus}
                                    onChange={(e) => setSelectedStatus(e.target.value)}
                                    className="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                                >
                                    <option value="all">All Statuses</option>
                                    {statuses.map(status => (
                                        <option key={status} value={status}>{status}</option>
                                    ))}
                                </select>
                            </div>
                        </div>
                    </div>

                    <div className="bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden">
                        <div className="overflow-x-auto">
                            <table className="min-w-full divide-y divide-gray-200 dark:divide-gray-600">
                                <thead className="bg-gray-50 dark:bg-gray-800">
                                    <tr>
                                        <th 
                                            className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700"
                                            onClick={() => handleSort('date')}
                                        >
                                            Date
                                            {sortConfig.key === 'date' && (
                                                <span className="ml-1">
                                                    {sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì'}
                                                </span>
                                            )}
                                        </th>
                                        <th 
                                            className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700"
                                            onClick={() => handleSort('program')}
                                        >
                                            Program
                                            {sortConfig.key === 'program' && (
                                                <span className="ml-1">
                                                    {sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì'}
                                                </span>
                                            )}
                                        </th>
                                        <th 
                                            className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700"
                                            onClick={() => handleSort('clicks')}
                                        >
                                            Clicks
                                            {sortConfig.key === 'clicks' && (
                                                <span className="ml-1">
                                                    {sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì'}
                                                </span>
                                            )}
                                        </th>
                                        <th 
                                            className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700"
                                            onClick={() => handleSort('sales')}
                                        >
                                            Sales
                                            {sortConfig.key === 'sales' && (
                                                <span className="ml-1">
                                                    {sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì'}
                                                </span>
                                            )}
                                        </th>
                                        <th 
                                            className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700"
                                            onClick={() => handleSort('revenue')}
                                        >
                                            Revenue
                                            {sortConfig.key === 'revenue' && (
                                                <span className="ml-1">
                                                    {sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì'}
                                                </span>
                                            )}
                                        </th>
                                        <th 
                                            className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700"
                                            onClick={() => handleSort('commission')}
                                        >
                                            Commission
                                            {sortConfig.key === 'commission' && (
                                                <span className="ml-1">
                                                    {sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì'}
                                                </span>
                                            )}
                                        </th>
                                        <th 
                                            className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700"
                                            onClick={() => handleSort('status')}
                                        >
                                            Status
                                            {sortConfig.key === 'status' && (
                                                <span className="ml-1">
                                                    {sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì'}
                                                </span>
                                            )}
                                        </th>
                                        <th 
                                            className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700"
                                            onClick={() => handleSort('category')}
                                        >
                                            Category
                                            {sortConfig.key === 'category' && (
                                                <span className="ml-1">
                                                    {sortConfig.direction === 'asc' ? '‚Üë' : '‚Üì'}
                                                </span>
                                            )}
                                        </th>
                                    </tr>
                                </thead>
                                <tbody className="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-600">
                                    {filteredEarnings.map((earning) => (
                                        <tr key={earning.id}>
                                            <td className="px-6 py-4 whitespace-nowrap">
                                                <div className="text-sm text-gray-900 dark:text-white">{earning.date}</div>
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap">
                                                <div className="text-sm font-medium text-gray-900 dark:text-white">
                                                    {earning.program}
                                                </div>
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap">
                                                <div className="text-sm text-gray-900 dark:text-white">{earning.clicks}</div>
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap">
                                                <div className="text-sm text-gray-900 dark:text-white">{earning.sales}</div>
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap">
                                                <div className="text-sm text-gray-900 dark:text-white">
                                                    ${earning.revenue.toFixed(2)}
                                                </div>
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap">
                                                <div className="text-sm text-gray-900 dark:text-white">
                                                    ${earning.commission.toFixed(2)}
                                                </div>
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap">
                                                <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${
                                                    earning.status === 'paid'
                                                        ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200'
                                                        : 'bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200'
                                                }`}>
                                                    {earning.status}
                                                </span>
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap">
                                                <div className="text-sm text-gray-900 dark:text-white">{earning.category}</div>
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap">
                                                <DeleteButton onDelete={() => handleDeleteEarning(earning.id)} itemName={earning.program} />
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <ClearDataButton section="Earnings" onClear={() => setEarnings([])} />
                </div>
            );
        }

        function Settings() {
            const { isDarkMode, toggleDarkMode } = React.useContext(ThemeContext);
            const [settings, setSettings] = React.useState({
                emailNotifications: true,
                desktopNotifications: false,
                currency: 'USD',
                timezone: 'EST',
                language: 'en'
            });

            const currencies = ['USD', 'EUR', 'GBP', 'AUD', 'CAD'];
            const timezones = ['EST', 'CST', 'MST', 'PST', 'GMT'];
            const languages = ['English', 'Spanish', 'French', 'German'];

            const handleSettingChange = (setting, value) => {
                setSettings(prev => ({
                    ...prev,
                    [setting]: value
                }));
            };

            return (
                <div className="settings-panel p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg">
                    <h1 className="text-2xl font-bold mb-6 text-gray-900 dark:text-white">Settings</h1>
                    
                    <div className="space-y-6">
                        {/* Theme Settings */}
                        <div className="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                            <h2 className="text-lg font-medium mb-4 text-gray-900 dark:text-white">Theme</h2>
                            <div className="space-y-4">
                                <div className="flex items-center justify-between">
                                    <span className="text-gray-700 dark:text-gray-300">Dark Mode</span>
                                    <button
                                        onClick={toggleDarkMode}
                                        className={`toggle-switch relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none ${
                                            isDarkMode ? 'bg-blue-600' : 'bg-gray-300'
                                        }`}
                                    >
                                        <span
                                            className={`inline-block w-4 h-4 transform transition-transform bg-white rounded-full ${
                                                isDarkMode ? 'translate-x-6' : 'translate-x-1'
                                            }`}
                                        />
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        {/* Notification Settings */}
                        <div className="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                            <h2 className="text-lg font-medium mb-4 text-gray-900 dark:text-white">Notifications</h2>
                            <div className="space-y-4">
                                <div className="flex items-center justify-between">
                                    <span className="text-gray-700 dark:text-gray-300">Email Notifications</span>
                                    <button
                                        onClick={() => handleSettingChange('emailNotifications', !settings.emailNotifications)}
                                        className={`relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none ${
                                            settings.emailNotifications ? 'bg-blue-600' : 'bg-gray-300'
                                        }`}
                                    >
                                        <span
                                            className={`inline-block w-4 h-4 transform transition-transform bg-white rounded-full ${
                                                settings.emailNotifications ? 'translate-x-6' : 'translate-x-1'
                                            }`}
                                        />
                                    </button>
                                </div>
                                <div className="flex items-center justify-between">
                                    <span className="text-gray-700 dark:text-gray-300">Desktop Notifications</span>
                                    <button
                                        onClick={() => handleSettingChange('desktopNotifications', !settings.desktopNotifications)}
                                        className={`relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none ${
                                            settings.desktopNotifications ? 'bg-blue-600' : 'bg-gray-300'
                                        }`}
                                    >
                                        <span
                                            className={`inline-block w-4 h-4 transform transition-transform bg-white rounded-full ${
                                                settings.desktopNotifications ? 'translate-x-6' : 'translate-x-1'
                                            }`}
                                        />
                                    </button>
                                </div>
                            </div>
                        </div>

                        {/* Regional Settings */}
                        <div className="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                            <h2 className="text-lg font-medium mb-4 text-gray-900 dark:text-white">Regional Settings</h2>
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                        Currency
                                    </label>
                                    <select
                                        value={settings.currency}
                                        onChange={(e) => handleSettingChange('currency', e.target.value)}
                                        className="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                                    >
                                        {currencies.map(currency => (
                                            <option key={currency} value={currency}>{currency}</option>
                                        ))}
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                        Timezone
                                    </label>
                                    <select
                                        value={settings.timezone}
                                        onChange={(e) => handleSettingChange('timezone', e.target.value)}
                                        className="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                                    >
                                        {timezones.map(timezone => (
                                            <option key={timezone} value={timezone}>{timezone}</option>
                                        ))}
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                        Language
                                    </label>
                                    <select
                                        value={settings.language}
                                        onChange={(e) => handleSettingChange('language', e.target.value)}
                                        className="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"
                                    >
                                        {languages.map(language => (
                                            <option key={language} value={language}>{language}</option>
                                        ))}
                                    </select>
                                </div>
                            </div>
                        </div>

                        {/* Save Button */}
                        <div className="flex justify-end">
                            <button
                                className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"
                                onClick={() => {
                                    // Save settings to localStorage
                                    localStorage.setItem('settings', JSON.stringify(settings));
                                    alert('Settings saved successfully!');
                                }}
                            >
                                Save Changes
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        function App() {
            const [currentPage, setCurrentPage] = React.useState('dashboard');
            const { isDarkMode } = React.useContext(ThemeContext);
            const [isLoading, setIsLoading] = React.useState(false);

            const renderPage = () => {
                switch (currentPage) {
                    case 'dashboard':
                        return <Dashboard />;
                    case 'ai':
                        return <AI />;
                    case 'applications':
                        return <Applications />;
                    case 'links':
                        return <LinkManager />;
                    case 'earnings':
                        return <Earnings />;
                    case 'settings':
                        return <Settings />;
                    default:
                        return <Dashboard />;
                }
            };

            return (
                <div className={`min-h-screen ${isDarkMode ? 'dark' : ''}`}>
                    <div className="flex h-full bg-gray-100 dark:bg-gray-900">
                        <Navigation onPageChange={setCurrentPage} currentPage={currentPage} />
                        <div className="flex-1 ml-64">
                            <Header />
                            <main className="p-6 bg-gray-100 dark:bg-gray-900 min-h-screen">
                                {renderPage()}
                            </main>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ThemeProvider><App /></ThemeProvider>);
    </script>
</body>
</html>
